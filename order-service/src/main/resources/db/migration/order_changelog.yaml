
  databaseChangeLog:
    - changeSet:
        id: 1
        author: admin
        changes:
          - createTable:
              tableName: Orders
              columns:
                - column:
                    name: order_id
                    type: BIGINT
                    autoIncrement: true
                    constraints:
                      primaryKey: true
                - column:
                    name: user_id
                    type: BIGINT
                    constraints:
                      nullable: false
                      # No FK to Users (in user_db)
                - column:
                    name: total_amount
                    type: DECIMAL(10,2)
                    constraints:
                      nullable: false
                - column:
                    name: status
                    type: VARCHAR(50)
                    constraints:
                      nullable: false
                - column:
                    name: created_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: updated_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: created_by
                    type: BIGINT
                - column:
                    name: updated_by
                    type: BIGINT
          - createIndex:
              tableName: Orders
              indexName: idx_orders_user_id
              columns:
                - column:
                    name: user_id
          - createIndex:
              tableName: Orders
              indexName: idx_orders_status
              columns:
                - column:
                    name: status
    - changeSet:
        id: 2
        author: admin
        changes:
          - createTable:
              tableName: Order_Items
              columns:
                - column:
                    name: order_item_id
                    type: BIGINT
                    autoIncrement: true
                    constraints:
                      primaryKey: true
                - column:
                    name: order_id
                    type: BIGINT
                    constraints:
                      nullable: false
                - column:
                    name: product_id
                    type: BIGINT
                    constraints:
                      nullable: false
                      # No FK to Products (in product_db)
                - column:
                    name: quantity
                    type: INT
                    constraints:
                      nullable: false
                      defaultValue: 1
                - column:
                    name: unit_price
                    type: DECIMAL(10,2)
                    constraints:
                      nullable: false
                - column:
                    name: created_by
                    type: BIGINT
                - column:
                    name: updated_by
                    type: BIGINT
          - addUniqueConstraint:
              tableName: Order_Items
              columnNames: order_id, product_id
          - createIndex:
              tableName: Order_Items
              indexName: idx_order_items_order_id
              columns:
                - column:
                    name: order_id
          - createIndex:
              tableName: Order_Items
              indexName: idx_order_items_product_id
              columns:
                - column:
                    name: product_id
