  databaseChangeLog:
    - changeSet:
        id: 1 # add "categories" table
        author: admin
        changes:
          - createTable:
              tableName: categories
              columns:
                - column:
                    name: category_id
                    type: BIGINT
                    autoIncrement: true
                    constraints:
                      primaryKey: true
                - column:
                    name: name
                    type: VARCHAR(100)
                    constraints:
                      nullable: false
                - column:
                    name: description
                    type: TEXT
                - column:
                    name: parent_id
                    type: BIGINT
                - column:
                    name: created_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: updated_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: created_by
                    type: BIGINT
                - column:
                    name: updated_by
                    type: BIGINT
                - column:
                    name: is_deleted
                    type: BOOLEAN
                    defaultValueBoolean: false
                    constraints:
                      nullable: false
          - createIndex:
              tableName: categories
              indexName: idx_categories_name
              columns:
                - column:
                    name: name
          - createIndex:
              tableName: categories
              indexName: idx_categories_parent_id
              columns:
                - column:
                    name: parent_id

    - changeSet:
        id: 2 # add "brands" table
        author: admin
        changes:
          - createTable:
              tableName: brands
              columns:
                - column:
                    name: brand_id
                    type: BIGINT
                    autoIncrement: true
                    constraints:
                      primaryKey: true
                - column:
                    name: name
                    type: VARCHAR(100)
                    constraints:
                      nullable: false
                - column:
                    name: description
                    type: TEXT
                - column:
                    name: logo_url
                    type: VARCHAR(250)
                - column:
                    name: created_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: updated_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: created_by
                    type: BIGINT
                - column:
                    name: updated_by
                    type: BIGINT
                - column:
                    name: is_deleted
                    type: BOOLEAN
                    defaultValueBoolean: false
                    constraints:
                      nullable: false

    - changeSet:
        id: 3 # add "products" table
        author: admin
        changes:
          - createTable:
              tableName: products
              columns:
                - column:
                    name: product_id
                    type: BIGINT
                    autoIncrement: true
                    constraints:
                      primaryKey: true
                - column:
                    name: name
                    type: VARCHAR(200)
                    constraints:
                      nullable: false
                - column:
                    name: description
                    type: TEXT
                - column:
                    name: price
                    type: DECIMAL(10,2)
                - column:
                    name: stock_quantity
                    type: INT
                    constraints:
                      nullable: false
                      defaultValue: 0
                - column:
                    name: sku
                    type: VARCHAR(50)
                    constraints:
                      unique: true
                - column:
                    name: image_url
                    type: VARCHAR(255)
                - column:
                    name: brand_id
                    type: BIGINT
                    constraints:
                      nullable: false
                - column:
                    name: created_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: updated_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: is_active
                    type: BOOLEAN
                    defaultValueBoolean: true
                - column:
                    name: created_by
                    type: BIGINT
                - column:
                    name: updated_by
                    type: BIGINT
                - column:
                    name: is_deleted
                    type: BOOLEAN
                    defaultValueBoolean: false
                    constraints:
                      nullable: false
          - createIndex:
              tableName: products
              indexName: idx_products_name
              columns:
                - column:
                    name: name
          - createIndex:
              tableName: products
              indexName: idx_products_price
              columns:
                - column:
                    name: price
          - createIndex:
              tableName: products
              indexName: idx_products_stock_quantity
              columns:
                - column:
                    name: stock_quantity

    - changeSet:
        id: 4 # add "product_categories" table
        author: admin
        changes:
          - createTable:
              tableName: product_categories
              columns:
                - column:
                    name: product_id
                    type: BIGINT
                - column:
                    name: category_id
                    type: BIGINT

    - changeSet:
        id: 5 # add "reviews" table
        author: admin
        changes:
          - createTable:
              tableName: reviews
              columns:
                - column:
                    name: review_id
                    type: BIGINT
                    autoIncrement: true
                    constraints:
                      primaryKey: true
                - column:
                    name: product_id
                    type: BIGINT
                    constraints:
                      nullable: false
                - column:
                    name: user_id
                    type: BIGINT
                    constraints:
                      nullable: false
                - column:
                    name: rating
                    type: INT
                    constraints:
                      nullable: false
                - column:
                    name: comment
                    type: TEXT
                - column:
                    name: created_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: updated_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: created_by
                    type: BIGINT
                - column:
                    name: updated_by
                    type: BIGINT
          - createIndex:
              tableName: reviews
              indexName: idx_reviews_product_id
              columns:
                - column:
                    name: product_id
          - createIndex:
              tableName: reviews
              indexName: idx_reviews_user_id
              columns:
                - column:
                    name: user_id
          - addUniqueConstraint:
              tableName: reviews
              columnNames: product_id, user_id

    - changeSet:
        id: 6 # add "attributes" table
        author: admin
        changes:
          - createTable:
              tableName: attributes
              columns:
                - column:
                    name: attribute_id
                    type: BIGINT
                    autoIncrement: true
                    constraints:
                      primaryKey: true
                - column:
                    name: name
                    type: VARCHAR(100)
                    constraints:
                      nullable: false
                - column:
                    name: unit
                    type: VARCHAR(50)
                - column:
                    name: category_id
                    type: BIGINT
                - column:
                    name: created_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: updated_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: created_by
                    type: BIGINT
                - column:
                    name: updated_by
                    type: BIGINT
                - column:
                    name: is_deleted
                    type: BOOLEAN
                    defaultValueBoolean: false
                    constraints:
                      nullable: false
          - createIndex:
              tableName: attributes
              indexName: idx_attributes_category_id
              columns:
                - column:
                    name: category_id

    - changeSet:
        id: 7 # add "product_attributes" table
        author: admin
        changes:
          - createTable:
                tableName: product_attributes
                columns:
                  - column:
                      name: product_attribute_id
                      type: BIGINT
                      autoIncrement: true
                      constraints:
                        primaryKey: true
                  - column:
                      name: product_id
                      type: BIGINT
                      constraints:
                        nullable: false
                  - column:
                      name: attribute_id
                      type: BIGINT
                      constraints:
                        nullable: false
                  - column:
                      name: attribute_value
                      type: VARCHAR(50)
                  - column:
                      name: is_deleted
                      type: BOOLEAN
                      defaultValueBoolean: false
                      constraints:
                        nullable: false

    - changeSet:
        id: 8 # add "product_variants" table
        author: admin
        changes:
          - createTable:
              tableName: product_variants
              columns:
                - column:
                    name: product_variant_id
                    type: BIGINT
                    autoIncrement: true
                    constraints:
                      primaryKey: true
                - column:
                    name: product_id
                    type: BIGINT
                    constraints:
                      nullable: false
                - column:
                    name: name
                    type: VARCHAR(200)
                    constraints:
                      nullable: false
                - column:
                    name: sku
                    type: VARCHAR(50)
                    constraints:
                      unique: true
                - column:
                    name: attributes
                    type: JSONB
                    constraints:
                      nullable: false
                - column:
                    name: price
                    type: DECIMAL(10,2)
                    constraints:
                      nullable: false
                - column:
                    name: stock_quantity
                    type: INT
                    constraints:
                      nullable: false
                      defaultValue: 0
                - column:
                    name: is_active
                    type: BOOLEAN
                    constraints:
                      nullable: false
                      defaultValueBoolean: true
                - column:
                    name: is_deleted
                    type: BOOLEAN
                    defaultValueBoolean: false
                    constraints:
                      nullable: false
                - column:
                    name: created_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: updated_at
                    type: TIMESTAMP
                    defaultValueComputed: CURRENT_TIMESTAMP
                - column:
                    name: created_by
                    type: BIGINT
                - column:
                    name: updated_by
                    type: BIGINT